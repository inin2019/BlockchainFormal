\begin{zed}
Reporte::=~Okay~|~BloqueInvalido~|~Rechazo~\\
\\
\end{zed}
\begin{zed}
[FINGERPRINT,~TIMESTAMP,~DATA]\\
\end{zed}
\begin{schema}{Bloque}
fingerprint:FINGERPRINT\\
prevblock:~FINGERPRINT\\
indice:~\nat\\
timestamp:~TIMESTAMP\\
data:~DATA\\
\end{schema}
\begin{axdef}
getFingerprint~:~Bloque~\fun~FINGERPRINT\\
createFingerprint:~BloqueEntrada\fun~FINGERPRINT\\
\end{axdef}
\begin{zed}
[IPADDRESS]\\
\end{zed}
\begin{zed}
Status~::=~Activo~|~Inactivo\\
\end{zed}
\begin{schema}{Nodo}
IP:~IPADDRESS\\
Estado:~Status\\
cadena:~\seq~Bloque\\
\end{schema}
\begin{schema}{BloqueEntrada}
prevblock:~FINGERPRINT~\\
indice:~\nat\\
timestamp:~TIMESTAMP\\
data:~DATA\\
\end{schema}
\begin{schema}{CrearBloque}
entrada?:~BloqueEntrada\\
Nuevo!:~Bloque\\
\where
Nuevo!.fingerprint~=~createFingerprint~entrada?\\
Nuevo!.prevblock~=~entrada?.prevblock\\
Nuevo!.indice~=~entrada?.indice\\
Nuevo!.timestamp~=~entrada?.timestamp\\
Nuevo!.data~=~entrada?.data\\
\end{schema}
\begin{schema}{ValidarBloque}
\Xi Nodo\\
bloque?:~Bloque\\
m!:~Reporte\\
\where
bloque?.prevblock~=~(last~cadena).fingerprint\\
getFingerprint(bloque?)~=~bloque?.fingerprint\\
bloque?.indice~=~(last~cadena).indice~+~1\\
m!~=~Okay\\
\end{schema}
\begin{schema}{AgregarCadenaOk}
\Delta Nodo\\
nuevo?:~Bloque\\
m!:~Reporte\\
\where
nuevo?.prevblock~=~(last~cadena).fingerprint\\
nuevo?.fingerprint~=~getFingerprint(nuevo?)\\
cadena'~=~cadena~\cat~\langle nuevo?\rangle\\
m!~=Okay\\
\end{schema}
\begin{schema}{ReemplazarCadena}
\Delta Nodo\\
nuevaCadena?:~\seq~Bloque\\
\where
\#nuevaCadena?~>~\#cadena\\
cadena'~=~nuevaCadena?\\
\end{schema}
